name: Deploy_to_ec2

# Trigger deployment only on push to master branch
on:
  push:
    paths:
      - "**.py"

jobs:
  deploy:
    name: Deploy to EC2 on master branch push
    runs-on: ubuntu-latest

    steps:
      - name: Checkout the files
        uses: actions/checkout@v3
      
      - name: Deploy code to ec2 server
        uses: kostya-ten/ssh-server-deploy@v4
        with:
          host: ${{ secrets.SSH_HOST }}
          port: ${{ secrets.SSH_PORT }}
          username: ${{ secrets.EC2_USERNAME}}
          password: "Cornet@123"
          scp_target: "/app/"
          after_script: |
            ls /app/carnot_tech
            
